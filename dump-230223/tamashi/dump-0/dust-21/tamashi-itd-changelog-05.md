# build 5
## Задачи
- Feature #6681: Исправления по билду 4. ET: 4/5/6. Spent: 5.00 h
- (wip) Feature #6688: Поддержка формул внутри значений конфига. ET: 8/9/10=9. Spent: 6h
- Feature #6689: Правки по ГДД v1.1: Менеджеры. ET: 6/8/10. Spent: 6.33 h

## dev 4.1
- Показываются все этажи на локации. Для недоступных отображается иконка замка.
- #bugfix Исправлена ошибка обновления ранга этажа.
- Названия порядков чисел изменены на латинские.
- #bugfix Исправлена отрисовка окна "списка сотрудников".
- Логика "списка сотрудников" изменена: вместо списка комнат с привязанными к ним сотрудниками, показывается полный список всех возможных сотрудников.
 
 ### Misc
- Открытие окна "деталей комнаты" происходит не при клике по комнате, а при клике на иконку сотрудника.
- Добавлены случайные названия для локаций и офисов.
- #bugfix В окне "деталей сотрудника" отображается корректное число до следующего апгрейда.
- Добавлено отображение надписей заголовка для разных игровых экранов.
- Добавлено отображение надписей заглововка для разных игровых локаций.
- Добавлено отображение надписей для офисов: в списке локаций, в окне деталей комнаты, в окне деталей сотрудника.
- Добавлен эффект инерции для перетаскивания этажей на экране локаций.

## dev 4.2

### Global
- Новая сущность: `ItemCards`. Поля конфигураций теперь поддерживают формулы, функции, и обращения к переменным. Пример поля: `@fn: level * 2`.
- Раздел конфига `employees` поддерживает формулы.

### Менеджеры
- Добавлен `employees.attackRate`. Изменен `employees.damage` -> `employees.attackDamage`.
- Добавлен  `employees.healthRegen`.
- Параметр `healthRegen` задает восстановление "hp в секунду" после боя.
- Изменен `employees.health` -> `employees.healthMax`.
- Добавлен `injuries`. `health` считается `healthMax - injuries`.
- Изменен `employees.upgradeCosts` -> `employees.levels`.
- Изменена механика апгрейда: Получение (апгрейд с уровня 0 на уровень 1) и апгрейд на уровень 2 и последующие происходит автоматически в момент получения игроком соответствующих карт менеджера.
- Кнопка "Улучшения" убрана из "Окна деталей менеджера"
- Заменен текст прогресс бара в "окне персонала" на "level X". Значение прогресс бара указывает на проценты до следующего уровня.
- Изменено: После "истощения" менеджера запускается таймер, по прошествии которого восстанавливается hp менеджера -> Сразу по окончании боя, все истощённые менеджеры получают +1 энергию и переводятся в состояние №3 (активен).
- Добавлена механика пассивных способностей для менеджеров и оборудования
- Добавлена пассивная способность: `profit_bonus`,  "Бонус к доходу с этажа"
- Добавлена пассивная способность: `upgrade_bonus`, "Скидка на апгрейд этажа"
- Добавлена пассивная способность: `threshold_bonus`, "Ускорение генерации дохода этажа"

### UI
- Иконки эмоджи в панели валют заменены текстурами