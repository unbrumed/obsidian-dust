# Dungeon inc. , общие механики
## Profit 

**desc**:

Profit - функция от времени. Количество валюты, которое игрок получит за промежуток времени (с последнего вызова этой функции в случае кликера). 

### Profit sources
- Каждый profit source приносит X валюты каждые N sec. Или, альтернативно: X/N в секунду, сбор валюты возможен каждые N sec
- Upgrades - повышение уровня. Каждый уровень увеличивает X, каждые L уровней уменьшается N
-  

### Global profit
Сумма всех profit sources
- Может быть умножен бонусами

```javascript

... class ProfitSource

/*
 * @param {Number} time time in seconds	
 */
profit(time) { // recursive
	let money = 0;
	
	if(!this.ready(time)) {
		return money;
	}
	
	money += this._profitSec * time;
	
	for(const k in this.profitSources) {
		money += this.profitSources[k].profit(time);
	}
	
	return money;
}

```

**comm**

- ~3h на реализацию общей механики
- +Xh тщательно покрыть тестами и обкатывать 

## Формулы повышения стоимости и доходов
**desc**
- Все суммы апгрейдов и доходов повышаются пропорционально какому-то коэффициенту
- Грубо: (`Stage № * Room № * Room level * Room rank`)

**comm**
- Выудить из геймдизов математику зависимостей чисел от предыдущих чисел и воткнуть в игру
- Если такой не подгонят, нужно будет самостоятельно прописывать, +Xh

## Этажи, локации
**desc**:
- Этаж - profit source и часть пути для юнитов во время рейда. На один этаж игрок может поставить одного своего юнита *(Игровой жаргон: сотрудника)*
- Локация - набор этажей. При открытии нового этажа становится доступен следующий
- Каждая локация и этаж - profit source. 
- Пользователь повышает уровнь этажам вручную

**comm**:
- Просто учитывать при организации структуры данных
- *Систему подсчета баланса надо расписать отдельно*

## Time events
**desc**:
- События, обновляющиеся по времени.
	- Вращение колеса на множитель профита, сбрасывается через несколько часов
	- Бесплатный сундук в магазине, доступен каждые несколько часов
	- Спаун новых рейдов

**comm**:
- Нужен общий менеджер событий от времени.
- ~3h общую логику, по контенту нужно уточнаять
	
## Relics
**desc**:
- Модификаторы с уникальными эффектами
	- `Boost profit x16 while in app`

**comm**:
- По ТЗ надо смотреть насколько эффекты уникальны. Для каждого уникального эффекта ~1h работы, общие эффекты объеденить.

## Quests/Tasks
**desc**:
- Общая механика подсчета игровых характеристик
	- `[room(s)][level(s)]`
	- `[room(s)] [rank] in [location]`
	- `[raid(s)] finished`
	- `[auditor(s)] [type] [kill(s)]`
	- `[auditor(s)] [type] [tap(s)]`
	- `gold total`
	- `gold profit`
	- `[employee(s)]`
	- `[employee(s)][level(s)]`
	- ...
- Daily login rewards

**comm**:
- Нужен полный список квестов, проработать и сгуппировать все по типам.
- ~1-3h на трекинг каждого типа квеста

## "Auditor raids"
**desc**:
- Тоже **Time events**. Через определенный промежуток времени спаунится новый raid. Само событие рейда запускается по пользовательскому инпуту
- Каждый рейд - набор юнитов, двигающихся линейно по шкале прогресса 0-1. Рейд заканчивается если юнит доходит до 1, или если юнитов не остается.
- Игрок может поставить своих юнитов или ловушки, им присваивается свое значение на шкале прогресса. Вражеский юнит не двигается дальше, если упирается в защиту
- При столновении юнитов они наносяд друг другу урон. У каждого юнита есть параметр атаки, дальности атаки, скорости атаки и здоровья.
- Игрок может наносить урон юнитам тапами (Зависит от уровня этажа) или способностями

**comm**:
- ~10h на реализацию игрового цикла рейдов
- +Xh оттестировать пользовательские инпуты, корректные расположения юнитов и урона, т.п.
- +Xh добавить типы юнитов, атак, контент ловушек

## "Сотрудники", юниты игрока
**desc**:
- Статы дальности атаки, урона, скорости, и скорости передвижения(?)
- Уровень. Повышается при получении карточки-дубликата
- Каждый сотрудник имеет уникальный эффект

**comm**:
- Часть с рейдом решается в задаче с рейдом
- Уникальные характеристики прописывать индивидуально

## Inventory
- Пользовательский инвентарь содержит:
	- Валюты разных типов
	- "Карточки" юнитов, ловушкек и способностей. Уровень каждой карточки поднимается при получении новых карточек того же типа

## Random drop
**desc**:
- С сундуков случаным образом падают новые предметы, валюта и модификаторы
- От качества сундука зависит качество и количество лута
- Судя по всему есть сундуки с презаданным лутом (для туториалов)

**comm**:
- ~3h на систему дропов и рандома,
- +Xh балансить и подгонять под ТЗ, тестировать

## Dialogs, tutorials
**desc**:
- По событиям выскакивают диалоги и катсцены
- Туториалы подсвечивают необходимые элементы, сохраняют свой прогресс

**comm**:
- Триггеры диалогов в кучу к системе квестов.
- События и контент диалогов менеджерить отдельной системой, +3h
- Туториалы тестить индивидуально. Необходимо организовывать структуру игры сразу с возможностью подсветки индивидуальных элементов.
- Тестить такие штуки дольше всего
- ~5-20h 