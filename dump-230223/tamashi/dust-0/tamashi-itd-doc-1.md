# Таблица конфигурации itd
## Overview
В таблице конфигурации строки - отдельные объекты. Колонки - поля этих объектов.
### Статичные значения
По умолчанию значение ячейки экспортируется как число, строка, или массив.
- Массивы - перечисления значений через запятую. Необходимо избегать пробелов после запятой в массивах со строковыми значениями.
### Функции
Некоторые поля конфигураций поддерживают формулы, функции, и обращения к переменным. 

*Функции не поддерживаются всеми полями, но при необходимости возможно добавить их для нужных*

Для переключения поля в режим функции нужно вписать `@fn: ` в начале ячейки. 
Пример поля: `@fn: level * 2`.
- Переменными могут быть названия других полей из конфигурации и некоторые внутренние, не задаваемые в таблице, значения
- Функциями могут быть любые [функции из math.js](https://mathjs.org/docs/reference/functions.html) и некоторые внутренние функции, список которых можно расширить по необходимости
- Формулами могут быть любые выражения, поддерживаемые [синтаксом math.js](https://mathjs.org/docs/expressions/syntax.html)
## Разделы таблицы
### stages
Игровые "Локации".
- `psources`. Список привязанных к локации этажей
- `cost`. Стоимость открытия локации
- `name`. Отображаемое имя
### psources
"Этажи", "Источники дохода"
- `profit`. Доход этажа в секунду
- `threshold`. Порог частоты сбора валюты в секундах
- `thresholdLevels`. Уровни, на которых порог сбора будет делен надвое
- `clickDamage`. Урон по таскам во время боя
- `rankLevels`. Уровни, на которых ранг этажа повышается
- `name`. Отображаемое имя
### employees
"Менеджеры". Все поля поддерживают формулы
- `healthMax`. Максимальное здоровье
- `healthRegen`. Восстановление hp/сек вне боя
- `attackRate`. Частота атаки, в ms
- `attackDamage`. Урон атаки
- `levels`. Кол-во карточек, необходимое для получения каждого следующего уровня. Первый элемент - первый уровень, и т.д.
- `stage`. Необходимый открытый этап для возможности выпадения карточки из сундука
- `weigh`. "Вес" при выпадении из сундуков
- `name`. Отображаемое имя
- `icon`. Отображаемая иконка
- `animation`. Отображаемая анимация при расположении на этаже
- `profit_bonus`. Множитель дохода на этаже
- `upgrade_bonus`. Множитель стоимости улучшения этажа
- `threshold_bonus`. Множитель порога частоты сбора валюты этажа
### tasks
"Задачи" (враги) в "спринтах" (бою). Поля повторяют свойства **employees**.
### gadgets
- `weigh`. "Вес" при выпадении из сундуков
- `levels`. Кол-во карточек, необходимое для получения каждого следующего уровня. Первый элемент - первый уровень, и т.д.
- `stage`. Необходимый открытый этап для возможности выпадения карточки из сундука
- `animation`. Отображаемая анимация при расположении на этаже
- `name`. Отображаемое имя
- `icon`. Отображаемая иконка
- `effectType`. Доступны значения: `heal`, `attack`, `poison`, `boost`, `slowdown`, `freeze`.
- `chargesMax`. Максимальное кол-во зарядов
- `gadgets.effectValue`:
	- `heal`: абсолютное значение (Прим.: `100`)
	- `attack`: абсолютное значение (Прим.: `100`)
	- `poison`: три значения через запятую. Урон, частота (в секундах), продолжительность (в секундах) (Прим.: `100,0.5,10` будет 10сек наносить 100 урона каждые полсекунды)
	- `boost`: два значения через запятую. Множитель скорости атак менеджера, продолжительность (в секундах) (Прим.: `10,10` увеличивает скорость атаки в 10 раз на 10 сек)
	- `slowdown`: два значения через запятую. Делитель скорости атак юнитов, продолжительность (в секундах) (Прим.: `10,10` уменьшает скорость атаки юнитов в 10 раз на 10 сек)
- `gadgets.regenRate` - частота восстановления зарядов вне боя. Задается в секундах
- `triggers`. Содержимое поля - js код. (Пример: `here.employeeHealth <= 0.5 || here.enemiesTotalDamage > 1000`)

Триггеры

- `employeeHealth`. "Процент здоровья менеджера на этаже". Значение `0-1` где `1` - полное здоровье. 
- `enemiesTotalDamage`. "Враги суммарно нанесли X урона на этаже". Абсолютное значение. Сбрасывается при срабатывании триггера.
- `employeeTotalDamage`. "Менеджер суммарно нанёс X урона на этаже". Абсолютное значение. Сбрасывается при срабатывании триггера.
- `enemiesKilled`. "На этаже убито X юнитов". Абсолютное значение. Сбрасывается при срабатывании триггера.
- `enemiesHitsMade`. "Враги суммарно нанесли X ударов на этаже". Абсолютное значение. Сбрасывается при срабатывании триггера.
- `employeeHitsMade`. "Менеджер суммарно нанес X ударов на этаже". Абсолютное значение. Сбрасывается при срабатывании триггера.
- `enemiesLeftTotal`. "Всего в спринтах осталось X тасков". Абсолютное значение.
- `battleDuration`. "Время с появления первого таска на этаже". Значение в секундах.

Способности

- Лечебное (`heal`): Восстанавливает **X** здоровья менеджеру на этаже.
- Атакующее (`attack`): Наносит **X** повреждений всем юнитам на этаже.
- Отравляющее (`poison`): С момента срабатывания тригера **N** секунд наносит **X** урона с частотой **F**
- Ускоряющее (`boost`): С момента срабатывания на **N** секунд увеличивает  `attackRate` менеджера в **X** раз
-  Замедляющее (`slowdown`): С момента срабатывания на **N** секунд уменьшает `attackRate` юнитов в **X** раз
- Замораживающее (`freeze`): С момента срабатывания на **N** секунд отключает атаки юнитов
### currencies
Игровые валюты.
- `weight`. "Вес" при выпадении из сундуков
- `amount`. Стартовое значение
### lootpacks
"Сундуки". 
**Устаревший синтаксис полей, необходимо переписать до поддержки формул**
- `pool`. Список ID пулов или ID самих предметов
- `weight`. Суммарный вес всех предметов, которые выпадут из сундука
- `icon`. Отображаемая иконка
-  `{ID}`. Отдельными колонками добавляются ID, указанные в `pool`. 
### pools
Просто список ID.
- `list`. Список id
### game
Общеигровые значения
- `scales_names`. Именные названия степеней тысячи*
- `floors_rank_names`. Имена ранков этажей (В `psources.rankLevels`)
- `battle_rewards_lootpacks`. Награды за победу в бою. (Пример: `lp0,lp0,lp0,lp1,lp2` даст:  lp0 за победу в 1-3 спринтах, lp1 за победу в 4 спринтах, lp2 за победу в 5 спринтах)